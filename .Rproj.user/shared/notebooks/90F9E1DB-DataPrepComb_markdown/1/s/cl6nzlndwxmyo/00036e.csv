"0",""
"0","strt.combinded.par <- strt.combinded.par %>%"
"0","  dplyr::rename(datetimeAK = DateTime)"
"0",""
"0","strt.combinded.par <- strt.combinded.par %>%"
"0","  dplyr::rename(light = Calibrated.Value)"
"0",""
"0","strt.combinded.par$datetimeAK <- as.POSIXct(strt.combinded.par$datetimeAK)"
"0",""
"0","strt.combinded.par$datetimeAK <- lubridate::round_date(strt.combinded.par$datetimeAK, ""15 minutes"") "
"0",""
"0",""
"0",""
"0","#depth rating curve"
"0","strt.depth <- strt.depth %>% filter(datetimeAK >= ""2019-05-21 14:45:00"")"
"0",""
"0",""
"0","strt.depth <- strt.depth %>%"
"0","  dplyr::rename(depth = RatingCurveDepth)"
"0",""
"0","strt.depth$datetimeAK <- as.POSIXct(strt.depth$datetimeAK)"
"0",""
"0","setDT(strt.depth)[, datetimeAK := datetimeAK[1L], "
"0","                  by = cumsum(as.POSIXlt(datetimeAK, format = ""%m/%d/%Y %H:%M"")$min %% 15 == 0)]"
"0",""
"0","strt.depth <- aggregate(depth ~ datetimeAK, data=strt.depth, FUN=mean)"
"0",""
"0",""
"0","#Combine"
"0",""
"0","STRT.comb <- merge(All.years.strt.MESSY, STRT.ALL.Q, "
"0","                   # strt.depth, strt.combinded.par,strt.ap.data, "
"0","                   by = ""datetimeAK"", all = TRUE)"
"0","STRT.comb <- merge(STRT.comb, strt.depth,"
"0","                   # strt.combinded.par,strt.ap.data, "
"0","                   by = ""datetimeAK"", all = TRUE)"
"0","STRT.comb <- merge(STRT.comb, strt.combinded.par,"
"0","                   # strt.ap.data, "
"0","                   by = ""datetimeAK"", all = TRUE)"
"0",""
"0","test1 <- strt.ap.data[-c(1)]"
"0",""
"0","STRT.comb <- merge(STRT.comb, test1,"
"0","                   # , "
"0","                   by = ""datetimeAK"", all = TRUE)"
"0",""
"0",""
"0","# DO SAT CALCS Summary"
"0","STRT.comb$DO.sat.EXO = STRT.comb$DO.obs /(STRT.comb$ODO.Psat/100)"
"0",""
"0","STRT.comb$datetimeAK <- as.POSIXct(STRT.comb$datetimeAK) "
"0",""
"0","STRT.comb$solar.time <- calc_solar_time(STRT.comb$datetimeAK,-146.915323)"
"0",""
"0","STRT.comb$light[STRT.comb$datetimeAK >= '2019-08-23 14:15:00' & STRT.comb$datetimeAK <= '2019-09-17 12:00:00'] <- NA"
"0",""
"0","STRT.comb$datetimeAK <- as.character(STRT.comb$datetimeAK)"
"0",""
"0",""
"0","light2020formax <- STRT.comb %>% filter(datetimeAK >= '2020-00-00 14:15:00' & datetimeAK <= '2021-00-00 00:00:00')"
"0","max(light2020formax$light, na.rm = TRUE)"
"1","[1]"
"1"," 1837.836"
"1","
"
"0","light2021formax <- STRT.comb %>% filter(STRT.comb$datetimeAK >= '2021-00-00 14:15:00' & STRT.comb$datetimeAK <= '2022-00-00 00:00:00')"
"0","max(light2021formax$light, na.rm = TRUE)"
"1","[1]"
"1"," 1932.084"
"1","
"
"0","STRT.comb$modeled.light <- calc_light(STRT.comb$solar.time, 64.754280, -146.477647, max.PAR = 1932.084)"
"0",""
"0",""
"0","# STRT.comb$light[STRT.comb$datetimeAK >= '2019-08-23 14:15:00' & STRT.comb$datetimeAK <= '2019-09-17 12:00:00'] <- STRT.comb$modeled.light"
"0",""
"0",""
"0","STRT.comb.fill.light <- STRT.comb %>% filter(STRT.comb$datetimeAK >= '2019-08-23 14:15:00' & STRT.comb$datetimeAK <= '2019-09-17 12:00:00') %>% "
"0","  mutate(light = coalesce(light,modeled.light))"
"0",""
"0",""
"0","STRT.comb.1 <- STRT.comb %>% filter(STRT.comb$datetimeAK < '2019-08-23 14:15:00')"
"0",""
"0","STRT.comb.3 <- STRT.comb %>% filter(STRT.comb$datetimeAK > '2019-09-17 12:00:00')"
"0",""
"0","STRT.comb <- rbind(STRT.comb.1, STRT.comb.fill.light, STRT.comb.3)"
"0",""
"0",""
"0",""
"0","STRT.comb <- distinct(STRT.comb)"
"0",""
"0","getwd()"
"1","[1]"
"1"," ""C:/Users/jadams125/Documents/GitHub/UAF-Metabolism"""
"1","
"
"0","write.csv(STRT.comb, here(""outputs"", ""strt.comb.csv""))"
"0",""
"0",""
"0","# ALL YEARS"
"0","strt.plot1 <- STRT.comb %>% "
"0","  mutate(DO.pctsat = 100 * (DO.obs / DO.sat.EXO)) %>%"
"0","  select(solar.time, starts_with('DO')) %>%"
"0","  gather(type, DO.value, starts_with('DO')) %>%"
"0","  mutate(units=ifelse(type == 'DO.pctsat', 'DO\n(% sat)', 'DO\n(mg/L)')) %>%"
"0","  ggplot(aes(x=solar.time, y=DO.value, color=type)) + geom_line() + "
"0","  facet_grid(units ~ ., scale='free_y') + theme_bw() +"
"0","  scale_color_discrete('variable') + labs(title = ""Stuart ODO, 2019 - 2021"")"
"0",""
"0","labels <- c(depth='depth\n(m)', temp.water='water temp\n(deg C)', light='PAR\n(umol m^-2 s^-1)', discharge='m^3/sec', air.pressure.mbar = 'mbar')"
"0","strtPlot2 <- STRT.comb %>% "
"0","  select(solar.time, depth, temp.water, light, discharge, air.pressure.mbar) %>%"
"0","  gather(type, value, depth, temp.water, light, discharge, air.pressure.mbar) %>%"
"0","  mutate("
"0","    type=ordered(type, levels=c('depth','temp.water','light','discharge', 'air.pressure.mbar')),"
"0","    units=ordered(labels[type], unname(labels))) %>%"
"0","  ggplot(aes(x=solar.time, y=value, color=type)) + geom_line() + "
"0","  facet_grid(units ~ ., scale='free_y') + theme_bw() +"
"0","  scale_color_discrete('variable')"
"0",""
"0","pdf(file = ""C:/Users/jadams125/documents/GitHub/UAF-Metabolism/Plots/STRT_comb_2019-2021.pdf"", height= 8.5)"
