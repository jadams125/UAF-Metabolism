"0","#DATA PREP SYNTHESIS"
"0",""
"0",""
"0","###################### DO DATA ##############################################"
"0","### Jacob Adams"
"0","### Full DoD DO Record Script"
"0","### 7/6/2022"
"0",""
"0","#Packages I think I might perhaps maybe need..."
"0","library(ggpubr)"
"2","Warning:"
"2"," package â€˜ggpubrâ€™ was built under R version 4.1.3
"
"2","Loading required package: ggplot2
"
"2","Warning:"
"2"," package â€˜ggplot2â€™ was built under R version 4.1.3
"
"0","library(anytime)"
"2","Warning:"
"2"," package â€˜anytimeâ€™ was built under R version 4.1.3
"
"0","library(googlesheets4)"
"2","Warning:"
"2"," package â€˜googlesheets4â€™ was built under R version 4.1.3
"
"0","library(ggpmisc)"
"2","Warning:"
"2"," package â€˜ggpmiscâ€™ was built under R version 4.1.3
"
"2","Loading required package: ggpp
"
"2","Warning:"
"2"," package â€˜ggppâ€™ was built under R version 4.1.3
"
"2","
Attaching package: â€˜ggppâ€™

"
"2","The following object is masked from â€˜package:ggplot2â€™:

    annotate

"
"2","Warning in .recacheSubclasses(def@className, def, env) :"
"2","
 "
"2"," undefined subclass ""packedMatrix"" of class ""replValueSp""; definition not updated
"
"2","Warning in .recacheSubclasses(def@className, def, env) :"
"2","
 "
"2"," undefined subclass ""packedMatrix"" of class ""mMatrix""; definition not updated
"
"0","library(plyr)"
"2","Warning:"
"2"," package â€˜plyrâ€™ was built under R version 4.1.3
"
"2","
Attaching package: â€˜plyrâ€™

"
"2","The following object is masked from â€˜package:ggpubrâ€™:

    mutate

"
"0","library(dplyr)"
"2","Warning:"
"2"," package â€˜dplyrâ€™ was built under R version 4.1.3
"
"2","
Attaching package: â€˜dplyrâ€™

"
"2","The following objects are masked from â€˜package:plyrâ€™:

    arrange, count, desc, failwith, id, mutate, rename, summarise, summarize

"
"2","The following objects are masked from â€˜package:statsâ€™:

    filter, lag

"
"2","The following objects are masked from â€˜package:baseâ€™:

    intersect, setdiff, setequal, union

"
"0","library(lubridate)"
"2","Warning:"
"2"," package â€˜lubridateâ€™ was built under R version 4.1.3
"
"2","
Attaching package: â€˜lubridateâ€™

"
"2","The following objects are masked from â€˜package:baseâ€™:

    date, intersect, setdiff, union

"
"0","library(tidyverse)"
"2","Warning:"
"2"," package â€˜tidyverseâ€™ was built under R version 4.1.3
"
"2","Registered S3 methods overwritten by 'dbplyr':
  method         from
  print.tbl_lazy     
  print.tbl_sql      
"
"1","-- [1mAttaching packages[22m --------------------------------------------------------- tidyverse 1.3.2 --
"
"1","[32mv[39m [34mtibble [39m 3.1.8     [32mv[39m [34mpurrr  [39m 0.3.5
[32mv[39m [34mtidyr  [39m 1.2.1     [32mv[39m [34mstringr[39m 1.4.1
[32mv[39m [34mreadr  [39m 2.1.3     [32mv[39m [34mforcats[39m 0.5.1
"
"2","Warning:"
"2"," package â€˜tibbleâ€™ was built under R version 4.1.3
"
"2","Warning:"
"2"," package â€˜tidyrâ€™ was built under R version 4.1.3
"
"2","Warning:"
"2"," package â€˜readrâ€™ was built under R version 4.1.3
"
"2","Warning:"
"2"," package â€˜purrrâ€™ was built under R version 4.1.3
"
"2","Warning:"
"2"," package â€˜stringrâ€™ was built under R version 4.1.3
"
"2","Warning:"
"2"," package â€˜forcatsâ€™ was built under R version 4.1.3
"
"1","-- [1mConflicts[22m ------------------------------------------------------------ tidyverse_conflicts() --
[31mx[39m [34mggpp[39m::[32mannotate()[39m         masks [34mggplot2[39m::annotate()
[31mx[39m [34mdplyr[39m::[32marrange()[39m         masks [34mplyr[39m::arrange()
[31mx[39m [34mlubridate[39m::[32mas.difftime()[39m masks [34mbase[39m::as.difftime()
[31mx[39m [34mpurrr[39m::[32mcompact()[39m         masks [34mplyr[39m::compact()
[31mx[39m [34mdplyr[39m::[32mcount()[39m           masks [34mplyr[39m::count()
[31mx[39m [34mlubridate[39m::[32mdate()[39m        masks [34mbase[39m::date()
[31mx[39m [34mdplyr[39m::[32mfailwith()[39m        masks [34mplyr[39m::failwith()
[31mx[39m [34mdplyr[39m::[32mfilter()[39m          masks [34mstats[39m::filter()
[31mx[39m [34mdplyr[39m::[32mid()[39m              masks [34mplyr[39m::id()
[31mx[39m [34mlubridate[39m::[32mintersect()[39m   masks [34mbase[39m::intersect()
[31mx[39m [34mdplyr[39m::[32mlag()[39m             masks [34mstats[39m::lag()
[31mx[39m [34mdplyr[39m::[32mmutate()[39m          masks [34mplyr[39m::mutate(), [34mggpubr[39m::mutate()
[31mx[39m [34mdplyr[39m::[32mrename()[39m          masks [34mplyr[39m::rename()
[31mx[39m [34mlubridate[39m::[32msetdiff()[39m     masks [34mbase[39m::setdiff()
[31mx[39m [34mdplyr[39m::[32msummarise()[39m       masks [34mplyr[39m::summarise()
[31mx[39m [34mdplyr[39m::[32msummarize()[39m       masks [34mplyr[39m::summarize()
[31mx[39m [34mlubridate[39m::[32munion()[39m       masks [34mbase[39m::union()
"
"0","library(lubridate)"
"0","library(ggplot2)"
"0","library(scales)"
"2","Warning:"
"2"," package â€˜scalesâ€™ was built under R version 4.1.3
"
"2","
Attaching package: â€˜scalesâ€™

"
"2","The following object is masked from â€˜package:purrrâ€™:

    discard

"
"2","The following object is masked from â€˜package:readrâ€™:

    col_factor

"
"0","library(zoo)"
"2","Warning:"
"2"," package â€˜zooâ€™ was built under R version 4.1.3
"
"2","
Attaching package: â€˜zooâ€™

"
"2","The following objects are masked from â€˜package:baseâ€™:

    as.Date, as.Date.numeric

"
"0","library(xts)"
"2","Warning:"
"2"," package â€˜xtsâ€™ was built under R version 4.1.3
"
"2","
Attaching package: â€˜xtsâ€™

"
"2","The following objects are masked from â€˜package:dplyrâ€™:

    first, last

"
"0","library(forecast)"
"2","Warning:"
"2"," package â€˜forecastâ€™ was built under R version 4.1.3
"
"2","Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo 
"
"2","
Attaching package: â€˜forecastâ€™

"
"2","The following object is masked from â€˜package:ggpubrâ€™:

    gghistogram

"
"0","library(googledrive)"
"2","Warning:"
"2"," package â€˜googledriveâ€™ was built under R version 4.1.3
"
"2","
Attaching package: â€˜googledriveâ€™

"
"2","The following objects are masked from â€˜package:googlesheets4â€™:

    request_generate, request_make

"
"0","library(streamMetabolizer)"
"2","USGS Active Research Package: https://owi.usgs.gov/R/packages.html#research
"
"2","This package was developed for research purposes. We used it for our own applications
and welcome flexible, resilient users who can help us test and improve the package.
Please give us feedback at https://github.com/USGS-R/streamMetabolizer/issues/new.
"
"0","library(readr)"
"0","library(data.table)"
"2","Warning:"
"2"," package â€˜data.tableâ€™ was built under R version 4.1.3
"
"2","Registered S3 method overwritten by 'data.table':
  method           from
  print.data.table     
"
"2","data.table 1.14.2 using 4 threads (see ?getDTthreads).  Latest news: r-datatable.com
"
"2","
Attaching package: â€˜data.tableâ€™

"
"2","The following objects are masked from â€˜package:xtsâ€™:

    first, last

"
"2","The following object is masked from â€˜package:purrrâ€™:

    transpose

"
"2","The following objects are masked from â€˜package:lubridateâ€™:

    hour, isoweek, mday, minute, month, quarter, second, wday, week, yday, year

"
"2","The following objects are masked from â€˜package:dplyrâ€™:

    between, first, last

"
"0","#calculate mg/L DO from Psat"
"0",""
"0","# Identify which records do not have proper DO data for METAB run"
"0",""
"0",""
"0",""
"0",""
"0","########POKE ########"
"0",""
"0","### 2019 ###"
"0","#Read cleaned CSVs from DoD 2019 Script "
"0",""
"0","SondeData2019 <- read_csv(""C:/Users/jadams125/documents/GitHub/DoD_2019/processed_sensor_dat/SUNA.EXO.int.corr.csv"")"
"1","[1mRows: [22m[34m76357[39m [1mColumns: [22m[34m60[39m
"
"1","[36m--[39m [1mColumn specification[22m [36m--------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m   (2): site.ID, Site
[32mdbl[39m  (56): fDOM.QSU.mn, fDOM.QSU.SD, ODO.Psat.mn, ODO.Psat.SD, ODO.Ploc.mn, ODO.Ploc.SD, ODO.m...
[34mdttm[39m  (2): datetimeAK, min
"
"1","
[36mi[39m Use `spec()` to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set `show_col_types = FALSE` to quiet this message.
"
"0","SondeData2019$datetimeAK <- force_tz(as.POSIXct(SondeData2019$datetimeAK), ""America/Anchorage"")"
"0",""
"0","# Have to rename rows so they dont have ""mean"" in them so it can be combined for three straight years. Data is cleaned."
"0",""
"0","SondeData2019.renamed <- SondeData2019 %>%"
"0","  dplyr::rename(ODO.mgL = ODO.mgL.mn, ODO.Psat = ODO.Psat.mn, ODO.Ploc = ODO.Ploc.mn, Temp.C = Temp.C.mn) %>% select(datetimeAK, Temp.C, ODO.mgL, ODO.Psat, ODO.Ploc, site.ID)"
"0",""
"0",""
"0","POKE_EXO_cl.2019.renamed <- SondeData2019.renamed %>% filter(site.ID == ""POKE"")"
"0",""
"0","# "
"0","# "
"0","# POKE_EXO_cl.2019 <- read_csv(""C:/Users/jadams125/documents/GitHub/DoD_2019/EXO_processed/POKE.EXO.cl.csv"")"
"0","# "
"0","# POKE_EXO_cl.2019$datetimeAK <- force_tz(as.POSIXct(POKE_EXO_cl.2019$datetimeAK), ""America/Anchorage"")"
"0","# # Have to rename rows so they dont have ""mean"" in them so it can be combined for three straight years. Data is not cleaned."
"0","# "
"0","# POKE_EXO_cl.2019.renamed <- POKE_EXO_cl.2019 %>%"
"0","#   dplyr::rename(ODO.mgL = ODO.mgL.mn, ODO.Psat = ODO.Psat.mn, ODO.Ploc = ODO.Ploc.mn, Temp.C = Temp.C.mn) %>% select(datetimeAK, Temp.C, ODO.mgL, ODO.Psat, ODO.Ploc)"
"0","# "
"0",""
"0",""
"0","#ROUGHLY convert %LOC to mg/L with Air pressure at time of install"
"0","poke.2019.air.P.url <- ""https://drive.google.com/drive/u/1/folders/12-av--A9_rqcyvwOl9EiB0MSZdmWnPcj"""
"0","poke_19.ap <- drive_get(as_id(poke.2019.air.P.url))"
"1","The [34mgoogledrive[39m package is requesting access to your Google account.
"
"1","Select a pre-authorised account or enter '0' to obtain a new token.
"
"1","Press Esc/Ctrl + C to cancel.
"
"1",""
"1","
"
"1","1: jadams125@alaska.edu"
"1","
"
"1",""
"1","
"
"0","1"
"0","poke_19.ap_glist <- drive_ls(poke_19.ap, pattern = ""191017_20005936_POKE_ATM.csv"")"
"1",""
"1"," "
"0","walk(poke_19.ap_glist$id, ~ drive_download(as_id(.x), overwrite = TRUE))"
"1","File downloaded:
"
"1","[36m*[39m [36m191017_20005936_POKE_ATM.csv[39m [90m<id: 1YAdKQHdaNF0q7z_XD_lwhjTgz61XQ0-A>[39m
"
"1","Saved locally as:
"
"1","[36m*[39m [34m191017_20005936_POKE_ATM.csv[39m
"
"0","poke.ap.2019.Data <- read.csv(""191017_20005936_POKE_ATM.csv"","
"0","                              skip = 1, header = TRUE)"
"0","poke.ap.2019.Data$DateTime <- as.POSIXct(strptime(poke.ap.2019.Data$Date.Time..GMT.08.00, ""%m/%d/%y %I:%M:%S %p""))"
"0",""
"0","poke.ap.2019.Data$DateTime <- lubridate::round_date(poke.ap.2019.Data$DateTime, ""15 minutes"") "
"0",""
"0","#row 2 is not a real row"
"0","poke.ap.2019.Data <- poke.ap.2019.Data[-c(2), ]"
"0",""
"0",""
"0","#convert to mmHg"
"0","poke.ap.2019.Data$pressure.mmHg <- poke.ap.2019.Data$Abs.Pres..kPa..LGR.S.N..20005936..SEN.S.N..20005936..LBL..P. * 7.50062"
"0",""
"0","#air pressure at start time: may 10, 2019 at 12:30"
"0","airPressureInstall <- poke.ap.2019.Data %>% filter(DateTime == ""2019-05-10 12:30:00"")"
"0",""
"0",""
"0","# #Get missed out of water point"
"0","# POKE_EXO_cl.2019.renamed.1 <- POKE_EXO_cl.2019.renamed %>% filter(datetimeAK <= ""2019-08-22 14:15:00"")"
"0","# "
"0","# "
"0","# POKE_EXO_cl.2019.renamed.2 <- POKE_EXO_cl.2019.renamed %>% filter(datetimeAK >= ""2019-08-22 16:00:00"")"
"0","# "
"0","# POKE_EXO_cl.2019.renamed <- rbind(POKE_EXO_cl.2019.renamed.1,POKE_EXO_cl.2019.renamed.2)"
"0",""
"0",""
"0",""
"0",""
"0","poke.exo.telemFilled.2019 <- POKE_EXO_cl.2019.renamed %>% filter(datetimeAK >= ""2019-08-22 15:00:00"" & datetimeAK <= ""2019-09-11 11:30:00"")"
"0",""
"0","#change pressure to match current record"
"0","poke.exo.telemFilled.2019$ODO.Psat <-  758.85 / 760 *  poke.exo.telemFilled.2019$ODO.Ploc"
"0",""
"0",""
"0","#convert from PSAT to mg/L using the formula the EXO uses"
"0","poke.exo.telemFilled.2019$ODO.mgL <- as.numeric(poke.exo.telemFilled.2019$ODO.Psat) * (0.01* exp("
"0","  (-862194900000*(1/(poke.exo.telemFilled.2019$Temp.C+273.15))^4+12438000000*(1/(poke.exo.telemFilled.2019$Temp.C+273.15))^3-66423080*(1/(poke.exo.telemFilled.2019$Temp.C+273.15))^2+157570.1*(1/(poke.exo.telemFilled.2019$Temp.C+273.15))-139.344)"
"0","  -0* (2140.7*(1/(poke.exo.telemFilled.2019$Temp.C+273.15))^2-10.754*(1/(poke.exo.telemFilled.2019$Temp.C+273.15))+0.017674 )))"
"0",""
"0",""
"0",""
"0",""
"0","#combine"
"0",""
"0","#Plot It"
"0",""
"0","pdf(file = ""C:/Users/jadams125/documents/GitHub/UAF-Metabolism/Plots/poke19filled.pdf"")"
"0",""
"0","plot(POKE_EXO_cl.2019.renamed$datetimeAK, POKE_EXO_cl.2019.renamed$ODO.Psat ,type=""l"",col=""black"", xlab = ""date"", ylab = ""ODO %Sat"",  ylim=c(93,107),)"
